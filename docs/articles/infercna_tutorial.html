<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tutorial with a single-cell dataset • infercna</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial with a single-cell dataset">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">infercna</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/infercna.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/infercna_tutorial.html">Tutorial with a single-cell dataset</a>
    </li>
    <li>
      <a href="../articles/useGenome.html">Set your Genome</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jlaffy/infercna">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Tutorial with a single-cell dataset</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jlaffy/infercna/blob/master/vignettes/infercna_tutorial.Rmd"><code>vignettes/infercna_tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>infercna_tutorial.Rmd</code></div>

    </div>

    
    
<div id="prepare-your-data" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-your-data" class="anchor"></a>Prepare your data</h2>
<div id="set-your-genome-with-usegenome" class="section level3">
<h3 class="hasAnchor">
<a href="#set-your-genome-with-usegenome" class="anchor"></a>Set your genome with <code>useGenome()</code>
</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="../reference/useGenome.html">useGenome</a></span>(<span class="st">'hg19'</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; Genome has been set to hg19</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="../reference/retrieveGenome.html">retrieveGenome</a></span>()</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt; Retrieving: hg19</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt; # A tibble: 33,575 x 8</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt;   symbol start_position end_position chromosome_name arm   band  strand</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt;   &lt;chr&gt;           &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;           &lt;fct&gt; &lt;chr&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt; 1 DDX11…          11869        14412 1               1p    p36.…      1</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt; 2 WASH7P          14363        29806 1               1p    p36.…     -1</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt; 3 MIR13…          29554        31109 1               1p    p36.…      1</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt; 4 FAM13…          34554        36081 1               1p    p36.…     -1</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt; # … with 33,571 more rows, and 1 more variable: ensembl_gene_id &lt;chr&gt;</span></a></code></pre></div>
</div>
<div id="load-example-data-with-usedata" class="section level3">
<h3 class="hasAnchor">
<a href="#load-example-data-with-usedata" class="anchor"></a>Load example data with <code>useData()</code>
</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">m =<span class="st"> </span><span class="kw"><a href="../reference/useData.html">useData</a></span>(mgh125)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(m)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; [1] 8556 1266</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/range.html">range</a></span>(m)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; [1]  0.000 15.328</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(refCells)</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; oligodendrocytes      macrophages </span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt;              219              707</span></a></code></pre></div>
</div>
</div>
<div id="infer-cnas-and-plot-a-heatmap" class="section level2">
<h2 class="hasAnchor">
<a href="#infer-cnas-and-plot-a-heatmap" class="anchor"></a>Infer CNAs and plot a heatmap</h2>
<div id="infer-cells-cna-profiles-with-infercna" class="section level3">
<h3 class="hasAnchor">
<a href="#infer-cells-cna-profiles-with-infercna" class="anchor"></a>Infer cells’ CNA profiles with <code>infercna()</code>
</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/args.html">args</a></span>(infercna)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; function (m, refCells = NULL, window = 100, range = c(-3, 3), </span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt;     n = NULL, noise = 0.1, center.method = "median", isLog = FALSE, </span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt;     verbose = TRUE) </span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb3-6" title="6">cna =<span class="st"> </span><span class="kw"><a href="../reference/infercna.html">infercna</a></span>(<span class="dt">m =</span> m, <span class="dt">refCells =</span> refCells, <span class="dt">n =</span> <span class="dv">5000</span>, <span class="dt">noise =</span> <span class="fl">0.1</span>, <span class="dt">isLog =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb3-7" title="7">cnaM =<span class="st"> </span>cna[, <span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(cna) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(refCells)]</a></code></pre></div>
</div>
<div id="plot-heatmap-with-cnaplot" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-heatmap-with-cnaplot" class="anchor"></a>Plot heatmap with <code>cnaPlot()</code>
</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/args.html">args</a></span>(cnaPlot)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; function (cna, limits = c(-1, 1), ratio = 0.5, cols = heatCols, </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt;     x.name = "Chromosome", y.name = "Cell", legend.title = "Inferred CNA\n[log2 ratio]", </span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt;     x.hide = c("13", "18", "21", "Y"), orderCells = F, order.with = NULL, </span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="co">#&gt;     euclid.dist = F, angle = NULL, x.angle = NULL, y.angle = 0, </span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt;     axis.rel = 1, base.size = 12, axis.title.size = 12, axis.text.size = 11, </span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">#&gt;     base.col = "#073642", title = NULL, subtitle = NULL, caption = NULL, </span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt;     text.size = 12, y.hide = NULL, tile.size = 0.1, tile.col = NULL, </span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt;     legend.position = "right", legend.height = 2, legend.width = 0.6, </span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt;     legend.rel = 0.9, legend.colour = "black", legend.breaks = NULL, </span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt;     legend.labels = NULL, legend.justification = "top", legend.title.position = "bottom", </span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt;     legend.title.angle = NULL, legend.title.rel = 0.9) </span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb4-14" title="14">obj =<span class="st"> </span><span class="kw"><a href="../reference/cnaPlot.html">cnaPlot</a></span>(<span class="dt">cna =</span> cnaM,</a>
<a class="sourceLine" id="cb4-15" title="15">              <span class="dt">orderCells =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb4-16" title="16">              <span class="dt">subtitle =</span> <span class="st">'Copy-Number Aberrations in a patient with Glioblastoma'</span>)</a>
<a class="sourceLine" id="cb4-17" title="17"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(obj)</a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; [1] "p"    "data"</span></a>
<a class="sourceLine" id="cb4-19" title="19"></a>
<a class="sourceLine" id="cb4-20" title="20">obj<span class="op">$</span>data</a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt; # A tibble: 1,665,660 x 3</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt;   Gene   Cell            CNA</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">#&gt;   &lt;fct&gt;  &lt;fct&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb4-24" title="24"><span class="co">#&gt; 1 WASH7P MGH125-P2-H01     0</span></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="co">#&gt; 2 NOC2L  MGH125-P2-H01     0</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co">#&gt; 3 ISG15  MGH125-P2-H01     0</span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="co">#&gt; 4 SDF4   MGH125-P2-H01     0</span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="co">#&gt; # … with 1,665,656 more rows</span></a>
<a class="sourceLine" id="cb4-29" title="29"></a>
<a class="sourceLine" id="cb4-30" title="30">obj<span class="op">$</span>p</a></code></pre></div>
<p><img src="infercna_tutorial_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div id="ordering-cells-in-cnaplot" class="section level3">
<h3 class="hasAnchor">
<a href="#ordering-cells-in-cnaplot" class="anchor"></a>Ordering cells in <code>cnaPlot()</code>
</h3>
<p>In cases where you can see the subclones in the heatmap but don’t yet have the subclone assignments to direct the cell clustering, you can instead give a set of chromosome and chromosome arms that you would like the clustering to use. In the example above, we probably want the cells belonging to the presumed subclones (chromosome 2, chromosome arm 4p, etc) to be grouped together. We can specify this using the <code>order.with</code> argument in <code><a href="../reference/cnaPlot.html">infercna::cnaPlot</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">obj =<span class="st"> </span><span class="kw"><a href="../reference/cnaPlot.html">cnaPlot</a></span>(<span class="dt">cna =</span> cnaM,</a>
<a class="sourceLine" id="cb5-2" title="2">              <span class="dt">orderCells =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb5-3" title="3">              <span class="dt">order.with =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="st">"4p"</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">15</span>),</a>
<a class="sourceLine" id="cb5-4" title="4">              <span class="dt">subtitle =</span> <span class="st">'Copy-Number Aberrations in a patient with Glioblastoma'</span>)</a>
<a class="sourceLine" id="cb5-5" title="5"></a>
<a class="sourceLine" id="cb5-6" title="6">obj<span class="op">$</span>p</a></code></pre></div>
<p><img src="infercna_tutorial_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
<div id="find-malignant-cells" class="section level2">
<h2 class="hasAnchor">
<a href="#find-malignant-cells" class="anchor"></a>Find malignant cells</h2>
<p>In the above section, we filtered out the <code><a href="../reference/refCells.html">infercna::refCells</a></code> that we know are normal prior to looking at the CNA heatmap. In reality, our reference normal cells will only comprise a subset of all normal cells in the data, and we will need to identify the remaining ones to exclude them from downstream analyses concerning the malignant cells <em>only</em>.</p>
<p>infercna defines two parameters, <code><a href="../reference/cnaCor.html">infercna::cnaCor</a></code> and <code><a href="../reference/cnaSignal.html">infercna::cnaSignal</a></code> that quantify the <em>extent</em> of copy-number aberrations in individual cells and thus help to separate the malignant and non-malignant subsets.</p>
<div id="compute-cnasignal-and-cnacor" class="section level3">
<h3 class="hasAnchor">
<a href="#compute-cnasignal-and-cnacor" class="anchor"></a>Compute <code>cnaSignal()</code> and <code>cnaCor()</code>
</h3>
<p><strong>“CNA signal”</strong> reflects the overall extent of CNAs. It’s defined as the mean of the squares of CNA values across the genome and should therefore accentuate genome-wide differences in CNA profiles between malignant and non-malignant cells.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/args.html">args</a></span>(cnaSignal)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; function (cna, threshold = NULL) </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p><strong>Note:</strong> Here, and generally speaking, we use CNA signal values per <em>cell</em>, but they can also be useful per <em>gene</em>.</p>
<p><strong>“CNA correlation”</strong> refers to the correlation between the CNA profile of each cell and the average CNA profile of all cells. Best results are seen when correlating cells to the <strong>average CNA profile of cells from the corresponding tumour</strong> and, if possible, <strong>excluding from the average those already classified as non-malignant</strong>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/args.html">args</a></span>(cnaCor)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; function (cna, cor.method = "pearson", threshold = NULL, bySample = F, </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt;     samples = NULL, sep = "-|_", excludeFromAvg = NULL) </span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>Some note-worthy arguments in the call to <code><a href="../reference/cnaCor.html">infercna::cnaCor()</a></code>:</p>
<ul>
<li><p><code>&lt;samples&gt;</code> : the names of tumours that will be used to split the matrix and correlate cells to their tumour’s average profile.</p></li>
<li><p><code>&lt;excludeFromAvg&gt;</code> : names of the (normal) cells to be excluded from the average profile.</p></li>
</ul>
</div>
<div id="visualise-cna-signal-and-correlation-with-cnascatterplot" class="section level3">
<h3 class="hasAnchor">
<a href="#visualise-cna-signal-and-correlation-with-cnascatterplot" class="anchor"></a>Visualise CNA Signal and Correlation with <code>cnaScatterPlot()</code>
</h3>
<p>Plotting <code>cnaCor</code> against <code>cnaSignal</code> for all cells is a good first approximation to the malignant and non-malignant groups. <code><a href="../reference/cnaScatterPlot.html">infercna::cnaScatterPlot</a></code> simply integrates these two function calls and their respective parameters into one function, and plots the results.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/args.html">args</a></span>(cnaScatterPlot)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; function (cna, cor.method = "pearson", threshold = NULL, cor.threshold = threshold, </span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt;     signal.threshold = threshold, group = NULL, group.col = "magenta", </span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt;     hline = NULL, vline = NULL, bySample = FALSE, samples = NULL, </span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt;     sep = "-|_", excludeFromAvg = NULL, ...) </span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw"><a href="../reference/cnaScatterPlot.html">cnaScatterPlot</a></span>(<span class="dt">cna =</span> cna, <span class="dt">samples =</span> <span class="st">'MGH125'</span>, <span class="dt">excludeFromAvg =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(refCells))</a>
<a class="sourceLine" id="cb8-9" title="9"><span class="kw"><a href="../reference/cnaScatterPlot.html">cnaScatterPlot</a></span>(<span class="dt">cna =</span> cna, <span class="dt">samples =</span> <span class="st">'MGH125'</span>, <span class="dt">excludeFromAvg =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(refCells), <span class="dt">group =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(refCells), <span class="dt">main =</span> <span class="st">'Highlight a subset of cells with &lt;group&gt;'</span>)</a></code></pre></div>
<p><img src="infercna_tutorial_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Let’s quickly go over the arguments:</p>
<ul>
<li><p>threshol Below is the result default <code>cnaCor</code> and <code>cnaSignal</code> parameters, with no specification of:</p></li>
<li><p><code>threshold</code> : to reduce top genes</p></li>
<li><p><code>samples</code> :</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw"><a href="../reference/cnaScatterPlot.html">cnaScatterPlot</a></span>(<span class="dt">cna =</span> cna, <span class="dt">threshold =</span> <span class="fl">.9</span>, <span class="dt">samples =</span> <span class="st">'MGH125'</span>, <span class="dt">group =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(refCells), <span class="dt">excludeFromAvg =</span> <span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(refCells))</a></code></pre></div>
<p><img src="infercna_tutorial_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div id="calculate-using-top-cna-signal-genes-only-with-cnahotspotgenes" class="section level4">
<h4 class="hasAnchor">
<a href="#calculate-using-top-cna-signal-genes-only-with-cnahotspotgenes" class="anchor"></a>Calculate using top CNA-Signal genes only, with <code>cnaHotspotGenes()</code>
</h4>
<p>You may have noticed the <code>&lt;threshold&gt;</code> argument, both in <code><a href="../reference/cnaSignal.html">infercna::cnaSignal</a></code> and in <code><a href="../reference/cnaCor.html">infercna::cnaCor</a></code>. If set to a value <strong>i</strong> between 0 and 1, these functions internally call <code><a href="../reference/cnaHotspotGenes.html">infercna::cnaHotspotGenes()</a></code>, which does two things:</p>
<ol style="list-style-type: decimal">
<li><p>Compute CNA signal values for each <em>gene</em></p></li>
<li><p>Return genes with values of CNA signal in the top <code>1 - **i** %</code></p></li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/args.html">args</a></span>(cnaHotspotGenes)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; function (cna, threshold) </span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; NULL</span></a>
<a class="sourceLine" id="cb10-4" title="4"></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co"># Number of genes in top 50%</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="../reference/cnaHotspotGenes.html">cnaHotspotGenes</a></span>(<span class="dt">cna =</span> cnaM, <span class="dt">threshold =</span> <span class="fl">.5</span>))</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; [1] 2450</span></a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co"># Number of genes in top 10%</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="../reference/cnaHotspotGenes.html">cnaHotspotGenes</a></span>(<span class="dt">cna =</span> cnaM, <span class="dt">threshold =</span> <span class="fl">.9</span>))</a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt; [1] 490</span></a></code></pre></div>
</div>
</div>
</div>
<div id="find-genetic-subclones" class="section level2">
<h2 class="hasAnchor">
<a href="#find-genetic-subclones" class="anchor"></a>Find genetic subclones</h2>
</div>
<div id="extra-functionality" class="section level2">
<h2 class="hasAnchor">
<a href="#extra-functionality" class="anchor"></a>Extra functionality</h2>
<p>There are many additional functions that are useful when conducting an analysis. We will explore these in future tutorials, but below is a selected list of some.</p>
<div id="split-filter-and-order-vectors-or-matrices-by-chromosome-arms" class="section level3">
<h3 class="hasAnchor">
<a href="#split-filter-and-order-vectors-or-matrices-by-chromosome-arms" class="anchor"></a>Split, Filter and Order vectors or matrices by Chromosome (Arms)</h3>
<ul>
<li><code><a href="../reference/splitGenes.html">splitGenes()</a></code></li>
<li><code><a href="../reference/orderGenes.html">orderGenes()</a></code></li>
<li><code><a href="../reference/filterGenes.html">filterGenes()</a></code></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">genesByChr =<span class="st"> </span><span class="kw"><a href="../reference/splitGenes.html">splitGenes</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(m), <span class="dt">by =</span> <span class="st">'chr'</span>)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/lengths.html">lengths</a></span>(genesByChr)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#&gt;   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18 </span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">#&gt; 844 593 502 295 432 391 473 297 313 262 458 466 153 269 240 354 490 115 </span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt;  19  20  21  22   X   Y </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#&gt; 549 238  86 186 305   5</span></a>
<a class="sourceLine" id="cb11-7" title="7"></a>
<a class="sourceLine" id="cb11-8" title="8">datByChr =<span class="st"> </span><span class="kw"><a href="../reference/splitGenes.html">splitGenes</a></span>(m, <span class="dt">by =</span> <span class="st">'arm'</span>)</a>
<a class="sourceLine" id="cb11-9" title="9"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(datByChr)</a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co">#&gt;  [1] "1p"  "1q"  "2p"  "2q"  "3p"  "3q"  "4p"  "4q"  "5p"  "5q"  "6p" </span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">#&gt; [12] "6q"  "7p"  "7q"  "8p"  "8q"  "9p"  "9q"  "10p" "10q" "11p" "11q"</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">#&gt; [23] "12p" "12q" "13q" "14q" "15q" "16p" "16q" "17p" "17q" "18p" "18q"</span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">#&gt; [34] "19p" "19q" "20p" "20q" "21p" "21q" "22q" "Xp"  "Xq"  "Yp"  "Yq"</span></a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="../reference/filterGenes.html">filterGenes</a></span>(m, <span class="st">'4p'</span>, <span class="st">'arm'</span>) <span class="op">%&gt;%</span><span class="st"> </span>nrow</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt; [1] 89</span></a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="kw"><a href="../reference/filterGenes.html">filterGenes</a></span>(m, <span class="st">'4p'</span>, <span class="st">'arm'</span>, <span class="dt">out =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>nrow</a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">#&gt; [1] 8467</span></a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="kw"><a href="../reference/filterGenes.html">filterGenes</a></span>(m, <span class="dv">2</span>, <span class="st">'chr'</span>) <span class="op">%&gt;%</span><span class="st"> </span>nrow</a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">#&gt; [1] 593</span></a>
<a class="sourceLine" id="cb12-9" title="9"></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="kw"><a href="../reference/filterGenes.html">filterGenes</a></span>(m, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="st">'4p'</span>), <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'chr'</span>, <span class="st">'arm'</span>)) <span class="op">%&gt;%</span><span class="st"> </span>nrow</a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">#&gt; [1] 682</span></a></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/all.html">all</a></span>(<span class="kw"><a href="../reference/orderGenes.html">orderGenes</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(m)) <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="kw"><a href="../reference/orderGenes.html">orderGenes</a></span>(m)))</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
</div>
<div id="probe-genes-on-specified-chromosomes-arms-with-geneson" class="section level3">
<h3 class="hasAnchor">
<a href="#probe-genes-on-specified-chromosomes-arms-with-geneson" class="anchor"></a>Probe genes on specified Chromosomes (Arms) with <code>genesOn()</code>
</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">chr7 =<span class="st"> </span><span class="kw"><a href="../reference/genesOn.html">genesOn</a></span>(<span class="dv">7</span>, <span class="st">'chr'</span>)</a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co"># First 5 genes on chromosome 7:</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(chr7, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co">#&gt; [1] "FAM20C"  "PDGFA"   "PRKAR1B" "HEATR2"  "SUN1"</span></a>
<a class="sourceLine" id="cb14-6" title="6"></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="st">'EGFR'</span> <span class="op">%in%</span><span class="st"> </span>chr7</a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
</div>
<div id="identify-high-cna-genes-with-cnahotspotgenes" class="section level3">
<h3 class="hasAnchor">
<a href="#identify-high-cna-genes-with-cnahotspotgenes" class="anchor"></a>Identify high-CNA genes with <code>cnaHotspotGenes()</code>
</h3>
<ul>
<li><code><a href="../reference/modality.html">modality()</a></code></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#prepare-your-data">Prepare your data</a></li>
      <li><a href="#infer-cnas-and-plot-a-heatmap">Infer CNAs and plot a heatmap</a></li>
      <li><a href="#find-malignant-cells">Find malignant cells</a></li>
      <li><a href="#find-genetic-subclones">Find genetic subclones</a></li>
      <li><a href="#extra-functionality">Extra functionality</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Julie Laffy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
